{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Parcel Token - {{ order.tracking_ID }}</title>
    <link href="{{ website_setting.fav_icon.url }}" rel="icon">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

    <style>
        @page {
            size: 3in 4in;
            margin: 0;
        }

        body {
            font-family: 'Inter', sans-serif;
            font-size: 12px;
            margin: 0;
            padding: 0;
            background: #fff;
            color: #000;
        }

        .invoice {
            width: 3in;
            height: 4in;
            background: #fff;
            border: 2px solid #000;
            border-radius: 10px;
            margin: 0 auto;
            padding: 20px 20px;
            box-sizing: border-box;
            position: relative;
            box-shadow: 0 0 4px rgba(0, 0, 0, 0.1);
        }

        /* HEADER SECTION */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            border-bottom: 1px dashed #000;
            margin-bottom: 5px;
        }

        .header-left img {
            height: 25px;
        }

        .header-right {
            text-align: right;
            font-size: 11px;
        }

        /* CUSTOMER SECTION */
        .customer {
            display: flex;
            justify-content: space-between;
        }

        .customer-left {
            width: 50%;
            font-size: 11px;
        }

        .customer-left p {
            margin: 1px 0;
        }

        .customer-right {
            text-align: right;
            width: 50%;
        }

        .barcode {
            display: block;
            font-family: 'Libre Barcode 39', monospace;
            font-size: 35px;
        }

        /* CUSTOMER ADDRESS SECTION */
        .customer-address {
            margin: auto;
            margin-bottom: 4px;

        }

        .customer-address p {
            margin: auto;
        }

        /* COURIER SECTION */
        .courier {
            border-top: 1px dashed #000;
            border-bottom: 1px dashed #000;
            text-align: center;
            padding-top: 5px;
            /* margin: 10px 0px;
            padding: 10px 0px; */
        }

        .courier h1 {
            font-size: 11px;
            margin: 0;
        }

        .courier p{
            margin: auto;
            padding: 0px;
        }

        /* PRODUCT TABLE */
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 11px;
        }

        th,
        td {
            padding: 2px 0;
            text-align: left;
        }

        th {
            border-bottom: 1px solid #000;
        }

        td:nth-child(2),
        td:nth-child(3) {
            text-align: center;
        }
        td:nth-child(4){
            text-align: right;
        }
        
        th:nth-child(2),
        th:nth-child(3) {
            text-align: center;
        }
        th:nth-child(4){
            text-align: right;
        }

        .summary {
            border-top: 1px dashed #000;
            margin-top: 3px;
            padding-top: 3px;
            font-size: 11px;
        }

        .summary p {
            margin: 1px 0;
            display: flex;
            justify-content: space-between;
        }

        /* PRINT BUTTON */
        .print-btn {
            background: #cb842a;
            color: #fff;
            border: none;
            padding: 5px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            margin-top: 6px;
        }

        .print-section {
            text-align: center;
            margin-top: 10px;
        }

        .footer-note {
            position: absolute;
            bottom: 5px;
            left: 0;
            width: 100%;
            text-align: center;
            font-size: 10px;
            color: #555;
        }

        @media print {
            body {
                margin: 0;
            }

            .print-section {
                display: none;
            }

            .invoice {
                page-break-inside: avoid;
                margin: 0;
                box-shadow: none;
            }
        }
    </style>

    <link href="https://fonts.googleapis.com/css2?family=Libre+Barcode+39&display=swap" rel="stylesheet">
</head>

<body>
    <div class="invoice">

        <!-- Header -->
        <div class="header">
            <div class="header-left">
                {% if website_setting.invoice_logo %}
                <img src="{{ website_setting.invoice_logo.url }}" alt="Logo">
                {% else %}
                <strong>{{ website_setting.website_name }}</strong>
                {% endif %}
            </div>
            <div class="header-right">
                <div>Date: {{ order.order_date|date:"m/d/Y" }}</div>
                <div>Invoice ID.: {{ order.tracking_ID }}</div>
            </div>
        </div>

        <!-- Customer Info -->
        <div class="customer">
            <div class="customer-left">
                <p><strong>
                        {% if order.request_order %}
                        {{ order.request_order.name }}
                        {% else %}
                        {{ order.order_customer.name }}
                        {% endif %}
                    </strong></p>
                <p>üìû
                    {% if order.request_order %}
                    {{ order.request_order.phone_number }}
                    {% else %}
                    {{ order.order_customer.phone_number }}
                    {% endif %}
                </p>

            </div>
            <div class="customer-right">
                <div class="barcode">{{ order.tracking_ID }}</div>
            </div>
        </div>
        <div class="customer-address">
            <p>{{ order.delivery_address }}</p>
        </div>

        <!-- Courier Info -->
        <div class="courier">
            {% if order.pathao_parcel_id or order.steadfast_parcel_id %}
            {% if order.pathao_parcel_id %}
            <p>Pathao Parcel</p>
            <h1>Parcel ID: {{ order.pathao_parcel_id }}</h1>
            {% endif %}
            {% if order.steadfast_parcel_id %}
            <p>SteadFast Parcel</p>
            <h1>Parcel ID: {{order.steadfast_parcel_id}}</h1>
            {% endif %}
            {% else %}
            <p style="margin: 5px 0px; padding-bottom: 5px;">No 3rd Party Logistic Company</p>
            {% endif %}
            <div class="barcode">
                {% if order.pathao_parcel_id or order.steadfast_parcel_id %}
                {% if order.pathao_parcel_id %}
                {{ order.pathao_parcel_id }}
                {% endif %}
                {% if order.steadfast_parcel_id %}
                {{order.steadfast_parcel_id}}
                {% endif %}
                {% endif %}
            </div>
        </div>

        <!-- Product List -->
        <div class="product-list-summary">
            <table>
                <thead>
                    <tr>
                        <th>Product</th>
                        <th>Qty</th>
                        <th>Price</th>
                        <th>Total</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in order.order_item.all %}
                    <tr>
                        <td>{{ item.product.name }}</td>
                        <td>{{ item.quantity }}</td>
                        <td>{{ item.unit_price }}</td>
                        <td>{{ item.total }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            <!-- Summary -->
            <div class="summary">
                <!-- <p><span>Sub Total:</span><span>{{ order.subtotal }}</span></p> -->
                <p><span>Delivery Fee:</span><span>
                        {% if order.delivery_charge %}
                        {{ order.delivery_charge }}
                        {% else %}
                        Free
                        {% endif %}
                    </span></p>
                <p><span>Advanced Payment:</span><span>
                        {{ order.advance_amount|default:'0' }}
                    </span></p>
                <p><strong><span>Due Amount:</span></strong><span>
                        {{ order.due_amount }}
                    </span></p>
            </div>
        </div>

        <div class="footer-note">
            Thank you for shopping with {{ website_setting.website_name|default:"Our Store" }}
        </div>
    </div>

    <!-- Print Button -->
    <div class="print-section">
        <button class="print-btn" onclick="window.print()">üñ®Ô∏è Print Token</button>
    </div>
</body>

</html>